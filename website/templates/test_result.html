{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="card">
        <div class="card-body">
            <h2 class="card-title">Результаты теста</h2>
            <h3>{{ result.test.title }}</h3>

            <div class="alert alert-{{ 'success' if result.passed else 'danger' }}">
                <h4 class="alert-heading">
                    {{ 'Тест пройден!' if result.passed else 'Тест не пройден' }}
                </h4>
                <p>Ваш результат: {{ result.percentage|round(1) }}%</p>
                <p>Проходной балл: {{ result.test.passing_score }}%</p>
                <p>Набрано баллов: {{ result.score }}</p>
                <p>Время выполнения: {{ result.time_taken // 60 }} мин {{ result.time_taken % 60 }} сек</p>
            </div>

            <h4>Детализация ответов:</h4>
            {% for detail in detailed_answers %}
            <div class="card mb-3">
                <div class="card-body">
                    <h5>Вопрос: {{ detail.question.text }}</h5>
                    <p class="text-{{ 'success' if detail.is_correct else 'danger' }}">
                        {{ 'Правильно' if detail.is_correct else 'Неправильно' }}
                    </p>

                    <p><strong>Ваши ответы:</strong></p>
                    <ul>
                        {% for answer in detail.user_answers %}
                        <li>{{ answer.text }}</li>
                        {% else %}
                        <li>Нет ответа</li>
                        {% endfor %}
                    </ul>

                    <p><strong>Правильные ответы:</strong></p>
                    <ul>
                        {% for answer in detail.correct_answers %}
                        <li>{{ answer.text }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endfor %}

            <a href="{{ url_for('main.tests') }}" class="btn btn-primary">Вернуться к тестам</a>
        </div>
    </div>
</div>
{% endblock %}